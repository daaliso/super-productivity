<nav class="mobile-bottom-nav">
  <!-- Menu Button -->
  <button
    class="nav-item"
    (click)="toggleMobileNav()"
  >
    <div class="nav-item-content">
      <mat-icon class="nav-icon">menu</mat-icon>
      <span class="nav-label">Menu</span>
    </div>
  </button>

  <!-- Today Button -->
  <button
    class="nav-item"
    [class.active]="currentRoute().includes('/tag/' + todayTagId + '/tasks')"
    [routerLink]="todayRoute"
  >
    <div class="nav-item-content">
      <span class="active-indicator"></span>
      <mat-icon class="nav-icon">wb_sunny</mat-icon>
      <span class="nav-label">Today</span>
    </div>
  </button>

  <!-- Add Task FAB -->
  <button
    mat-fab
    class="add-task-button"
    [class.smaller]="hasProjectBacklog()"
    color="primary"
    (click)="showAddTaskBar()"
  >
    <mat-icon>add</mat-icon>
  </button>

  <!-- Planner Button -->
  <button
    class="nav-item"
    [class.active]="currentRoute() === '/planner'"
    routerLink="/planner"
  >
    <div class="nav-item-content">
      <span class="active-indicator"></span>
      <mat-icon class="nav-icon">edit_calendar</mat-icon>
      <span class="nav-label">Planner</span>
    </div>
  </button>

  <!-- Panels Menu Button -->
  <button
    class="nav-item"
    [matMenuTriggerFor]="panelsMenu"
  >
    <div class="nav-item-content">
      <mat-icon class="nav-icon">view_sidebar</mat-icon>
      <span class="nav-label">Panels</span>
    </div>
  </button>
</nav>

<mat-menu
  #panelsMenu="matMenu"
  class="mobile-bottom-nav-panels-menu"
>
  @for (button of sidePanelButtons(); track button.pluginId) {
    <button
      mat-menu-item
      (click)="onPluginButtonClick(button)"
      [class.active]="activePluginId() === button.pluginId && isShowPluginPanel()"
    >
      <plugin-icon
        [pluginId]="button.pluginId"
        [fallbackIcon]="button.icon || 'extension'"
      ></plugin-icon>
      <span>{{ button.label }}</span>
    </button>
  }

  <button
    mat-menu-item
    [disabled]="!isRouteWithSidePanel()"
    [class.active]="isShowIssuePanel()"
    (click)="toggleIssuePanel()"
  >
    <mat-icon>dashboard_customize</mat-icon>
    <span>{{ T.BN.SHOW_ISSUE_PANEL | translate }}</span>
  </button>

  <button
    mat-menu-item
    [disabled]="!isRouteWithSidePanel()"
    [class.active]="isShowNotes()"
    (click)="toggleNotes()"
  >
    <mat-icon>comment</mat-icon>
    <span>{{ T.BN.SHOW_NOTES | translate }}</span>
  </button>
</mat-menu>
